# This is a basic workflow to help you get started with Actions

name: Trigger Error

on: [workflow_dispatch]

defaults:
  run:
    shell: powershell

env:
  workflowDepth: 1

jobs:
  build:
    name: ðŸš€ Build App
    #runs-on: ubuntu-latest
    runs-on: [ windows-latest ]
    steps:
      - name: Checkout source
        uses: actions/checkout@v2
        
      - name: Add Android platform
        run: cordova platform add android@11.0.0
        
      - name: Runs on job failure
        if: ${{ failure() }}
        run: |
          
          $Url = "https://api.github.com/repos/${{ github.repository }}/issues"
          $headers = @{
            'authorization' = 'Bearer ${{ secrets.GITHUB_TOKEN }}'
            'content-type' = 'application/json'
          }
          $Body = @{
              title = "Issue created due to workflow failure: ${{ github.run_id }}"
              body = "This issue was automatically created by the GitHub Action workflow **${{ github.workflow }}**. \n\n Step : **BUILD** \n\n due to failure in run: _${{ github.run_id }}_. ${{ github.event.pull_request.head.repo.owner.login }} "
          }
          Invoke-RestMethod -Uri $url -Method 'Post' -Headers $headers -Body $body

